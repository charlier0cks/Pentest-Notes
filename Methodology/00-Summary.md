202301220922
Status: #summary
Tags: [[Summary]]

# 00-Summary

### Precious - Linux

>A webserver hosting a website that converts a remote webpage into a pdf.
>We discovered that the website is using a tool called pdfkit to do the conversion.
>The website has a paramater URL that is vulnerable to RCE.
>Our RCE payload consisted of a reverse shell using ruby.
>To laterally move we found valid credentials in a file for a user.
>That new user had sudo privileges for a certain command and argument.
>We were able to write specific code into a yaml file that our ruby file handled.
>This ultimately allowed us to execute commands as root.

### Sauna - Windows

>This machine had characteristics of a domain controller and hosting a website as well. Our first step to establishing a foothold was by gathering all the full names displayed on the team section of the website. Then we were able to create different type of usernames that follow a specific naming conventions (ex: fsmith, f.smith). Then we used a tool called kerbrute that used our user file to validate which user existed. After getting a valid username, we were able to ASREProast that account and get the TGT hash. This allowed us to crack the hash and get a valid password. We logged in to the machine with our new credentials via winRM. We were able to use winPEAS to enumerate internally and found valid credentials for another user. After collecting all the data with SharpHound for BloodHound, we were able to see that our new user had permissions that allowed us to do a DCSync attack. We were able to use secretsdump.py to gather hashes. We successfully did a pass-the-hash attack that allowed us to authenticate as the Administrator.


## Forest - Windows

>This machine was a domain controller with no website hosted. We were able to enumerate for users with smb null authentication using crackmapexec. After gather a list of users, I was able to determine which user was ASREProastable. We retrieved the tgt from a service account "svc-alfresco." We then successfully cracked the hash and was able to obtain valid credentials. After getting a shell via winRM, we gathered all data for BloodHound and began our analysis. It turns out that the service account we now have credentials for, is part of a group that is nested into other groups with specific permissions . Specifically, the group "Account Operators" allowed us to add our service account to the group "Exchange Windows Permissions" which had write permissions to the DACL for the domain. After adding our account to that group, we gave ourselves DCSync rights for the domain and was able to successfully dump all hashes with secretsdump. This allowed us to pass the Administrator's hash to get a shell on the machine.




---
# References
