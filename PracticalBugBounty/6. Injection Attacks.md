## Local File Inclusion Attacks

- Exploited via user input due to poor validation and sanitization
- Endpoints are going to be parameters that take user input
- For example:

![[lfi1.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/lfi1.png">

- We can send different payloads to the `filename` parameter to see if it is vulnerable to LFI 

 ![[lfi2.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/lfi2.png">

- We were able to traverse paths to display the contents of the `/etc/passwd` file that contains users

## Remote File Inclusion Attacks

- It is the same concept as LFI, but you can display contents of a remote file.

## File Inclusion Demo

- We have a webpage that allows us to view different recipes using an api
- On Burp, we can see a filename parameter that takes in a txt file and displays the contents of that file

![[file_inclusion1.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/file_inclusion1.png">

- We can manually try different payloads, or we can fuzz this parameter with ffuf

`ffuf -c -u 'http://192.168.149.128/labs/api/fetchRecipe.php?filename=FUZZ' -w /usr/share/wordlists/seclists/SecLists-master/Fuzzing/LFI/LFI-Jhaddix.txt --fw 19,20
`
- This will fuzz the `filename` parameter and use the word-list provided that contains multiple payloads
- After executing the command we gets lots of results, we can filter out the responses that contain both 19, and 20 words
- This will leave us with a few results that we can try

![[file_inclusion2.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/file_inclusion2.png">

- We can try to get the results with curl

![[file_inclusion3.png]]

<img src="https://github.com/charlier0cks/Pentest-Notes/blob/main/Attachments/file_inclusion3.png">

- We can see that one of the payloads results in a successful LFI using filter bypassing


## Introduction to Cross-Site Scripting (XSS)

- Three types of XSS
	- Reflected
	- Stored
	- DOM-Based
- When testing for XSS, the `alert()` function can be outdated or filtered easily. Try using `print()` or `prompt()`

## Basic Cross-Site Scripting (XSS) Attacks

- Common payload, executes JS on error:

`<img src=x onerror="prompt(1)">`

## Stored Cross-Site Scripting

- Want to test XSS in two different sessions within the same browser?
- Use a container extension for Firefox, called Firefox multi-account containers
- Each container is its own session